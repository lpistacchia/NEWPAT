# **SNPcall**

**SNPcall** is a modified and simplified version of **DNPcall** for SNP-based calling using `samtools` pileup and a reference SNP list.
**SNPcall** assumes that the pileup has already been generated exactly as required for DNPcall and does not perform raw BAM processing itself.

**Reference:**
Letizia Pistacchia, Francesco Ravasini, Elisa Bella, Eugenia D’Atanasio, Fulvio Cruciani, Beniamino Trombetta, DNPcall: A New Pipeline for Accurate Double Nucleotide Polymorphism Calling, Bioinformatics Advances, 2025;, vbaf209, [https://doi.org/10.1093/bioadv/vbaf209](https://doi.org/10.1093/bioadv/vbaf209)

---

## **Folder Structure**

The folder contains:

```
SNPcall/
├── SNPcall.R          # main script
├── README.md          # this file
└── examples/
    ├── pileup.txt     # example pileup input
    ├── SNPlist.txt    # example SNP list input
    └── output.txt     # example output generated by SNPcall
```

This clearly shows where to place your input files and where the outputs will be stored.

---

## **Software required**

- **samtools** ≥ 1.18 (for pileup generation)  
- **R** ≥ 4.2.0  
- **R packages**:
  - `optparse`
  - `tidyverse`

> All required R packages must be installed before running.

---

## **Installation**

No installation is required. Just download/clone the repository and move into the directory:

```bash
git clone https://github.com/lpistacchia/NEWPAT.git
cd NEWPAT/SNPcall
```
---

## **Usage**

Run SNPcall from the command line:

```bash
Rscript SNPcall.R --pileup <pileup_file> --snplist <snp_list_file> --out <output_file>
```

---

## **Arguments**

| **Flag**    | **Description**                                         |
| ----------- | ------------------------------------------------------- |
| `--pileup`  | Path to the `samtools` pileup file                      |
| `--snplist` | Path to the SNP list file (**pos**, **ref**, **alt**)   |
| `--out`     | Desired output filename (default: `SNPcall_output.txt`) |

---

## **Examples**

Run the example files provided in this repository:

```bash
Rscript SNPcall.R \
  --pileup examples/pileup.txt \
  --snplist examples/SNPlist.txt \
  --out examples/output.txt
```

---

## **Output Table**

| **Column**        | **Description**                                                |
| ----------------- | -------------------------------------------------------------- |
| **chr**           | Chromosome                                                     |
| **pos**           | Position                                                       |
| **Reference**     | Reference allele                                               |
| **Alternative**   | Alternative allele                                             |
| **N_Reference**   | Count of reference reads                                       |
| **N_Alternative** | Count of alternative reads                                     |
| **N_Altro**       | Count of other reads                                           |
| **total_count**   | Total reads covering the SNP                                   |
| **ratio**         | Ratio of reference reads over total of reference + alternative |

---

## **Notes**

* Ensure your pileup file is generated following the DNPcall procedure.
* **SNPcall** does not process raw BAM files.

## Contact

For questions, please contact:

Letizia Pistacchia, letizia.pistacchia@uniroma1.it  


## Citation

If you use this module, please cite the original DNPcall paper:

Letizia Pistacchia, Francesco Ravasini, Elisa Bella, Eugenia D’Atanasio, Fulvio Cruciani, Beniamino Trombetta  
“DNPcall: A New Pipeline for Accurate Double Nucleotide Polymorphism Calling”  
Bioinformatics Advances, 2025; vbaf209 — https://doi.org/10.1093/bioadv/vbaf209
